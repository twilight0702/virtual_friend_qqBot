import{m as C,bY as R}from"./index-BzAQRMoo.js";import{g as k,i as S,j as z,$ as V,a as L,b as P}from"./SelectionManager-PNHCnM9c.js";import{r as f}from"./react-router-dom-BfuE-jt0.js";var T=C({base:"shrink-0 bg-divider border-none",variants:{orientation:{horizontal:"w-full h-divider",vertical:"h-full w-divider"}},defaultVariants:{orientation:"horizontal"}});class A{isDisabled(t){var e;return this.disabledBehavior==="all"&&(((e=t.props)===null||e===void 0?void 0:e.isDisabled)||this.disabledKeys.has(t.key))}findNextNonDisabled(t,e){let i=t;for(;i!=null;){let l=this.collection.getItem(i);if((l==null?void 0:l.type)==="item"&&!this.isDisabled(l))return i;i=e(i)}return null}getNextKey(t){let e=t;return e=this.collection.getKeyAfter(e),this.findNextNonDisabled(e,i=>this.collection.getKeyAfter(i))}getPreviousKey(t){let e=t;return e=this.collection.getKeyBefore(e),this.findNextNonDisabled(e,i=>this.collection.getKeyBefore(i))}findKey(t,e,i){let l=t,o=this.layoutDelegate.getItemRect(l);if(!o||l==null)return null;let n=o;do{if(l=e(l),l==null)break;o=this.layoutDelegate.getItemRect(l)}while(o&&i(n,o)&&l!=null);return l}isSameRow(t,e){return t.y===e.y||t.x!==e.x}isSameColumn(t,e){return t.x===e.x||t.y!==e.y}getKeyBelow(t){return this.layout==="grid"&&this.orientation==="vertical"?this.findKey(t,e=>this.getNextKey(e),this.isSameRow):this.getNextKey(t)}getKeyAbove(t){return this.layout==="grid"&&this.orientation==="vertical"?this.findKey(t,e=>this.getPreviousKey(e),this.isSameRow):this.getPreviousKey(t)}getNextColumn(t,e){return e?this.getPreviousKey(t):this.getNextKey(t)}getKeyRightOf(t){let e=this.direction==="ltr"?"getKeyRightOf":"getKeyLeftOf";return this.layoutDelegate[e]?(t=this.layoutDelegate[e](t),this.findNextNonDisabled(t,i=>this.layoutDelegate[e](i))):this.layout==="grid"?this.orientation==="vertical"?this.getNextColumn(t,this.direction==="rtl"):this.findKey(t,i=>this.getNextColumn(i,this.direction==="rtl"),this.isSameColumn):this.orientation==="horizontal"?this.getNextColumn(t,this.direction==="rtl"):null}getKeyLeftOf(t){let e=this.direction==="ltr"?"getKeyLeftOf":"getKeyRightOf";return this.layoutDelegate[e]?(t=this.layoutDelegate[e](t),this.findNextNonDisabled(t,i=>this.layoutDelegate[e](i))):this.layout==="grid"?this.orientation==="vertical"?this.getNextColumn(t,this.direction==="ltr"):this.findKey(t,i=>this.getNextColumn(i,this.direction==="ltr"),this.isSameColumn):this.orientation==="horizontal"?this.getNextColumn(t,this.direction==="ltr"):null}getFirstKey(){let t=this.collection.getFirstKey();return this.findNextNonDisabled(t,e=>this.collection.getKeyAfter(e))}getLastKey(){let t=this.collection.getLastKey();return this.findNextNonDisabled(t,e=>this.collection.getKeyBefore(e))}getKeyPageAbove(t){let e=this.ref.current,i=this.layoutDelegate.getItemRect(t);if(!i)return null;if(e&&!R(e))return this.getFirstKey();let l=t;if(this.orientation==="horizontal"){let o=Math.max(0,i.x+i.width-this.layoutDelegate.getVisibleRect().width);for(;i&&i.x>o&&l!=null;)l=this.getKeyAbove(l),i=l==null?null:this.layoutDelegate.getItemRect(l)}else{let o=Math.max(0,i.y+i.height-this.layoutDelegate.getVisibleRect().height);for(;i&&i.y>o&&l!=null;)l=this.getKeyAbove(l),i=l==null?null:this.layoutDelegate.getItemRect(l)}return l??this.getFirstKey()}getKeyPageBelow(t){let e=this.ref.current,i=this.layoutDelegate.getItemRect(t);if(!i)return null;if(e&&!R(e))return this.getLastKey();let l=t;if(this.orientation==="horizontal"){let o=Math.min(this.layoutDelegate.getContentSize().width,i.y-i.width+this.layoutDelegate.getVisibleRect().width);for(;i&&i.x<o&&l!=null;)l=this.getKeyBelow(l),i=l==null?null:this.layoutDelegate.getItemRect(l)}else{let o=Math.min(this.layoutDelegate.getContentSize().height,i.y-i.height+this.layoutDelegate.getVisibleRect().height);for(;i&&i.y<o&&l!=null;)l=this.getKeyBelow(l),i=l==null?null:this.layoutDelegate.getItemRect(l)}return l??this.getLastKey()}getKeyForSearch(t,e){if(!this.collator)return null;let i=this.collection,l=e||this.getFirstKey();for(;l!=null;){let o=i.getItem(l);if(!o)return null;let n=o.textValue.slice(0,t.length);if(o.textValue&&this.collator.compare(n,t)===0)return l;l=this.getNextKey(l)}return null}constructor(...t){if(t.length===1){let e=t[0];this.collection=e.collection,this.ref=e.ref,this.collator=e.collator,this.disabledKeys=e.disabledKeys||new Set,this.disabledBehavior=e.disabledBehavior||"all",this.orientation=e.orientation||"vertical",this.direction=e.direction,this.layout=e.layout||"stack",this.layoutDelegate=e.layoutDelegate||new k(e.ref)}else this.collection=t[0],this.disabledKeys=t[1],this.ref=t[2],this.collator=t[3],this.layout="stack",this.orientation="vertical",this.disabledBehavior="all",this.layoutDelegate=new k(this.ref);this.layout==="stack"&&this.orientation==="vertical"&&(this.getKeyLeftOf=void 0,this.getKeyRightOf=void 0)}}function W(a){let{selectionManager:t,collection:e,disabledKeys:i,ref:l,keyboardDelegate:o,layoutDelegate:n}=a,s=S({usage:"search",sensitivity:"base"}),K=t.disabledBehavior,c=f.useMemo(()=>o||new A({collection:e,disabledKeys:i,disabledBehavior:K,ref:l,collator:s,layoutDelegate:n}),[o,n,e,i,l,s,K]),{collectionProps:d}=z({...a,ref:l,selectionManager:t,keyboardDelegate:c});return{listProps:d}}class B{*[Symbol.iterator](){yield*this.iterable}get size(){return this.keyMap.size}getKeys(){return this.keyMap.keys()}getKeyBefore(t){let e=this.keyMap.get(t);var i;return e&&(i=e.prevKey)!==null&&i!==void 0?i:null}getKeyAfter(t){let e=this.keyMap.get(t);var i;return e&&(i=e.nextKey)!==null&&i!==void 0?i:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(t){var e;return(e=this.keyMap.get(t))!==null&&e!==void 0?e:null}at(t){const e=[...this.getKeys()];return this.getItem(e[t])}getChildren(t){let e=this.keyMap.get(t);return(e==null?void 0:e.childNodes)||[]}constructor(t){this.keyMap=new Map,this.firstKey=null,this.lastKey=null,this.iterable=t;let e=n=>{if(this.keyMap.set(n.key,n),n.childNodes&&n.type==="section")for(let s of n.childNodes)e(s)};for(let n of t)e(n);let i=null,l=0;for(let[n,s]of this.keyMap)i?(i.nextKey=n,s.prevKey=i.key):(this.firstKey=n,s.prevKey=void 0),s.type==="item"&&(s.index=l++),i=s,i.nextKey=void 0;var o;this.lastKey=(o=i==null?void 0:i.key)!==null&&o!==void 0?o:null}}function Y(a){let{filter:t,layoutDelegate:e}=a,i=V(a),l=f.useMemo(()=>a.disabledKeys?new Set(a.disabledKeys):new Set,[a.disabledKeys]),o=f.useCallback(d=>t?new B(t(d)):new B(d),[t]),n=f.useMemo(()=>({suppressTextValueWarning:a.suppressTextValueWarning}),[a.suppressTextValueWarning]),s=L(a,o,n),K=f.useMemo(()=>new P(s,i,{layoutDelegate:e}),[s,i,e]);const c=f.useRef(null);return f.useEffect(()=>{if(i.focusedKey!=null&&!s.getItem(i.focusedKey)&&c.current){const r=c.current.getItem(i.focusedKey),$=[...c.current.getKeys()].map(g=>{const h=c.current.getItem(g);return(h==null?void 0:h.type)==="item"?h:null}).filter(g=>g!==null),u=[...s.getKeys()].map(g=>{const h=s.getItem(g);return(h==null?void 0:h.type)==="item"?h:null}).filter(g=>g!==null);var d,v;const M=((d=$==null?void 0:$.length)!==null&&d!==void 0?d:0)-((v=u==null?void 0:u.length)!==null&&v!==void 0?v:0);var b,x,m;let y=Math.min(M>1?Math.max(((b=r==null?void 0:r.index)!==null&&b!==void 0?b:0)-M+1,0):(x=r==null?void 0:r.index)!==null&&x!==void 0?x:0,((m=u==null?void 0:u.length)!==null&&m!==void 0?m:0)-1),w=null,N=!1;for(;y>=0;){if(!K.isDisabled(u[y].key)){w=u[y];break}if(y<u.length-1&&!N)y++;else{N=!0;var D,p;y>((D=r==null?void 0:r.index)!==null&&D!==void 0?D:0)&&(y=(p=r==null?void 0:r.index)!==null&&p!==void 0?p:0),y--}}i.setFocusedKey(w?w.key:null)}c.current=s},[s,K,i,i.focusedKey]),{collection:s,disabledKeys:l,selectionManager:K}}export{W as $,Y as a,T as d};
